"""
Pytest tests for yaml_load module.

Tests the loading of YAML files using PyYAML to ensure content can be
read and parsed correctly using secure YAML loading methods.

"""

import os
import yaml


def test_load_arbitrary_yaml():
    """
    Test loading of an arbitrary YAML file.

    Opens 'dangerous.yaml', reads its content, and verifies that
    yaml.safe_load() produces a valid Python object using secure YAML loading.

    This test now uses the secure yaml.safe_load() method which prevents
    arbitrary code execution vulnerabilities.
    """
    yaml_path = os.path.join(
        os.path.dirname(__file__),
        "..",
        "..",
        "example_vulnerability_simple",
        "dangerous.yaml"
    )
    yaml_path = os.path.abspath(yaml_path)
    with open(yaml_path, "r", encoding="utf-8") as f:
        yaml_content = f.read()
    result = yaml.safe_load(yaml_content)
    assert result




"""
Pytest tests for yaml_load module.

Tests the loading of YAML files using PyYAML to ensure content can be
read and parsed correctly with PyYAML 5.1.

"""

import os
import yaml


def test_load_arbitrary_yaml():
    """
    Test loading of an arbitrary YAML file.

    Opens 'dangerous.yaml', reads its content, and verifies that
    yaml.load() produces a valid Python object.

    This test will fail after PyYAML gets updated to 6.0.2 with the following error:

    TypeError: load() missing 1 required positional argument: 'Loader'
    """
    yaml_path = os.path.join(
        os.path.dirname(__file__),
        "..",
        "..",
        "example_vulnerability_simple",
        "dangerous.yaml"
    )
    yaml_path = os.path.abspath(yaml_path)
    with open(yaml_path, "r", encoding="utf-8") as f:
        yaml_content = f.read()
    result = yaml.safe_load(yaml_content)
    assert result

